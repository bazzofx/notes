Source: [Modern Threat Hunting Series -2024](https://www.linkedin.com/learning/modern-threat-hunting-strategies-to-identify-attacks/permissions-and-deflecting-cyberattacks?autoSkip=true&resume=false&u=84863210)
Trainer:[Paula Januszkiewicz](https://www.linkedin.com/learning/instructors/paula-januszkiewicz?u=84863210)

# Gloassary
- ACEs  - Access Control Entries
- DACL - Discretionary Access Control List
- PIM - Privilege Identity Management
- PAM - Privilege Access Management
# Permissions and Priviledges
## Privilege Management

Privilege are part of the user #accesstoken.
Access Token are created when the user logon, if the user successful authenticate the system will create an access token
every process executed by the user has a copy of the token
The token identify the user, the user's group, and the user's privilege
There are two types of access token, primary and impersonated token
#impersonatedToken usually used during an attack, are access tokens that have been created to capture the secure information of a client process allowing a server to impersonate the client process in security operations

| Priviledges                                  | Permissions                                                |     |
| -------------------------------------------- | ---------------------------------------------------------- | --- |
| Control access to system resources and tasks | Define access to securable objects                         |     |
| System admin asign priviledge                | grant permissions on access rights on ACEs in objects DACL |     |
When user tries to perform a privilege operation the system checks if the user has the permissions and are enabled.

## Privilege Attacks
- Memory Dump
- Extracting Credentials (SED bug #mimikats)
- Copy files (SE Backup privilege)
- Copy SAM and SYSTEM database (extract hash using VSS Admin)
- Impersonate other session (SE impersonate privilege)
## Best Practices Permissions
- Audit Permissions regularly
- Assign permissions to groups
- Reserve "deny permissions" for special cases
- Use security templates
- Avoid changing default permission entries on file system objects
- Never deny the Everyone group object access
- Assign object permissions as high as possible
- Privileges can override permission
## Best Practices Permissions on AD
- Know best practices for Active Directory objects
- Apply principle of least privilege
- Implement role-based access control
- Ensure expiration of temporary privileges
- Automate enforcement policies